setup: setup.sh
cleanup: cleanup.sh
difficulty: medium
expect:
- contains: 'VIOLATING:'
- contains: resource-beta
- not_contains: resource-alpha
script:
- prompt: "This policy requires that all Pods in the `default` namespace use container\
    \ images sourced from specific repositories: `openpolicyagent/*`, `myregistry.azurecr.io/*`,\
    \ `mydockerhub/*`, the `ubuntu:20.14` image, or the `123456789123.dkr.ecr.eu-west-1.amazonaws.com/postgres`\
    \ image. Any Pod attempting to use an image from a different source will be rejected.\n\
    \    \nLook at the resources that have been deployed in namespace gk-test-000.\
    \ Examine them and determine which resource(s) violate the policy.\n\nAfter your\
    \ analysis, output a single line starting with \"VIOLATING:\" followed by the\
    \ resource name(s) that violate the policy, or \"VIOLATING: none\" if all resources\
    \ comply."
